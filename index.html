<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Canvas</title>
	<meta name="viewport" id="viewport" content="width=640,user-scalable=no,target-densitydpi=320">
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<meta name="full-screen" content="true"> 
	<meta name="screen-orientation" content="portrait"> 
	<meta name="x5-fullscreen" content="true"> 
	<meta name="360-fullscreen" content="true">
	<link href="cs/base.css" rel="stylesheet" type="text/css">
	<link href="cs/Mycs.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="cs/swiper3.1.0.min.css">
	<script src="js/createjs-2014.12.12.min.js"></script>
	<script src="js/jquery-2.1.1.min.js"type="text/javascript" charset="utf-8"></script>
	<script src='js/easeljs-0.8.0.min.js'></script>
	<script src="js/preloadjs-0.6.0.min.js"></script>
	<script src="js/swiper3.1.0.min.js"></script>
</head>
<body>
	<div id="wrap">
		<!-- audio -->
		<div id="media" class="hidden">
			<audio id="bgmusic" src="audio/cjyx.mp3" autoplay="" loop="" preload=""></audio>
		</div>
		<!-- audio.icon -->
		<a class="btn-menu" href="javascript:void(0);"><i class="icon-volume-high"></i></a>
		<!-- loading -->
		<div class="loading" style="display: none">
			<div class="load_rock"><img src="images/loading.gif"></div>
			<div class="load_right"><img src="images/right.jpg"></div>
			<div class="load_logo"><img src="images/logo.png" id="indexLoad"></div>
		</div>
		<!--loading end-->
		<!-- 模版选择 -->
		<div class="page swiper-container">
			<div class="page_box swiper-wrapper">
				<div class="page_icon1 swiper-slide" style="height: 765px;" sr="images/pop_bg1.png"></div>
				<div class="page_icon2 swiper-slide" style="height: 765px;" sr="images/pop_bg2.png"></div>
				<div class="page_icon3 swiper-slide" style="height: 765px;" sr="images/pop_bg3.png"></div>
			</div>
			<img src="images/btn_true.png" id="page_icon" class="upimg_canvas_btn_true" />
		</div>
		<!--主场相框 begin-->
	<div class="photo">
		<div class="photo_top">
			<canvas id="conCanvas" class="conCanvas"  width="640"></canvas>
			<a class="photo_btn3" href="javascript:void(0);">
				<input id="fileElem" type="file" accept="image/*" onchange="handleFiles()">
				<img src="images/btn_3.png">
			</a>
		</div>
	</div>
	<!-- updown -->
	<div class="upimg_canvas" id="op">
		<div class="upimg_can_masktop"></div>
		<div class="upimg_can_maskbot"></div>
		
		<canvas id="imgCanvas" class="imgCanvas" width="640"></canvas>
		<canvas id="hideCanvas" class="hideCanvas"></canvas>
		<img src="images/btn_true.png" class="upimg_canvas_btn_true" id="upimg_canvas" />
		<!-- <canvas id="resCanvas" class="resCanvas" width="640" height="640"></canvas> -->
	</div>
	<script type="text/javascript">
		var hasPic = 0;
		$(function(){
			$(".js_showSayBtn").on('touchstart',function(e){
				e.preventDefault();

				if (hasPic < 1) {
					alert('请上传图片');
					return false;
				}

				$(".uploadbox_sure").trigger('click');
			});
			$('#fileupload').on('touchstart',function(e){
				e.preventDefault();
				$("#fileupload").trigger('click');
			})
		});
	</script>
	</div>
</body>

<script src='js/megapix-image.js'></script>
<script src="js/touch.min.js"></script>
<script src="js/exif.min.js"></script>
<script src="js/main.js"></script>
<script> 
	var mySwiper = new Swiper('.swiper-container', {
		loop: true
	})
</script>
<!-- <script>
	// ios
  if ( /ipad|iphone|ipod|mac/i.test( ua ) ) {
    $('#fileupload').makeThumb({
      width:800,
      success: function(dataURL, tSize, file, sSize, fEvt) {
      callbacks (dataURL);
      }
    });  
  } else if ( /android/gi.test( ua ) && /MicroMessenger/gi.test(ua)  ) {
    initForAndroid ();
  }  else {
     $('#fileupload').makeThumb({
      width:800,
      success: function(dataURL, tSize, file, sSize, fEvt) {
    	  callbacks (dataURL);
      }
    });
  }

  function callbacks (data_url) {
    fadeIn ($c('uploadbox_sure'));
    $('.photo_replace_b').hide();
    
    //fadeIn($c('sure2'));

    //consoleLog(data_url, 'qain');
    var image = new Image();
    image.src = data_url;
    image.onload = function() {
       hasPic = 1;
       
      $("#piccanvas").editCanvas({
      control: "control", 
      element: "piccanvas", 
      width: $("#piccanvas").width(), 
      image: image, 
      commit2: "uploadbox_sure", 
      //commit: "sure2", 
      callback: function ( canvas ) {

        var fillterImg = $id('fillter_img');
        var CANVAS = document.createElement('canvas');
        CANVAS.width  = fillterImg.width;
        CANVAS.height = fillterImg.height;
        CANVAS.style.background='rgba(255,255,255,0)';
        
        var cxt = CANVAS.getContext('2d');
        
        var canTop = $id('piccanvas').offsetTop;
        var canLeft = $id('piccanvas').offsetLeft;

        cxt.drawImage (canvas, 0, 0, canvas.width, canvas.height,canLeft,canTop,canvas.width, canvas.height);
        
        cxt.drawImage (fillterImg, 0, 0, 640, 1008, 0, 0 ,fillterImg.width, fillterImg.height);
</script> -->


</html>